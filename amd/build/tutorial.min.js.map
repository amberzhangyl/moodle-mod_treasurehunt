{"version":3,"sources":["../src/tutorial.js"],"names":["define","$","jqui","introJS","str","notification","editpage","intro","cook","document","cookie","split","forEach","x","arr","trim","terms","stringQueried","map","term","key","component","get_strings","done","strings","configureEditIntro","setTimeout","start","fail","exception","playpage","configurePlayIntro","keys","setOptions","nextLabel","indexOf","prevLabel","skipLabel","doneLabel","steps","element","position","onexit","oncomplete","onchange","target","name","_currentStep","onafterchange","parentElem","parentElement","dataset","role","style"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * @module    mod_treasurehunt/tutorial\r\n * @package   mod_treasurehunt\r\n * @copyright 2016 onwards Juan Pablo de Castro <jpdecastro@tel.uva.es>\r\n * @author Juan Pablo de Castro <jpdecastro@tel.uva.es>\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\ndefine(['jquery', 'jqueryui', 'mod_treasurehunt/intro', 'core/str', 'core/notification'],\r\n        function ($, jqui, introJS, str, notification) {\r\n            var init = {\r\n                editpage: function () {\r\n                    var intro = introJS();\r\n                    var cook = {};\r\n                    document.cookie.split(';').forEach(function (x) {\r\n                        var arr = x.split('=');\r\n                        arr[1] && (cook[arr[0].trim()] = arr[1].trim());\r\n                    });\r\n                    if (cook[\"introEditProgress\"] != 'Done') {\r\n                        var terms = ['nextstep', 'prevstep', 'skiptutorial', 'donetutorial', 'welcome_edit_tour',\r\n                        \t'map_tour', 'mapplay_tour', 'roads_tour',\r\n                            'stages_tour', 'addroad_tour', 'addstage_tour', 'save_tour', 'editend_tour'];\r\n                        var stringQueried = terms.map(function (term) {\r\n                            return {key: term, component: 'treasurehunt'};\r\n                        });\r\n                        str.get_strings(stringQueried).done(function (strings) {\r\n                            configureEditIntro(intro, strings, terms);\r\n                            setTimeout(function () {\r\n                                intro.start();\r\n                            }, 1000);\r\n                        }).fail(notification.exception);\r\n                    }\r\n                }, // end of editpage function\r\n                playpage: function () {\r\n                    var intro = introJS();\r\n                    var cook = {};\r\n                    document.cookie.split(';').forEach(function (x) {\r\n                        var arr = x.split('=');\r\n                        arr[1] && (cook[arr[0].trim()] = arr[1].trim());\r\n                    });\r\n                    if (cook[\"introPlayProgress\"] != 'Done') {\r\n                        var terms = ['nextstep', 'prevstep', 'skiptutorial', 'donetutorial', 'welcome_play_tour', 'lastsuccessfulstage_tour', 'mapplay_tour', 'validatelocation_tour', 'autolocate_tour', 'playend_tour'];\r\n                        var stringQueried = terms.map(function (term) {\r\n                            return {key: term, component: 'treasurehunt'};\r\n                        });\r\n                        str.get_strings(stringQueried).done(function (strings) {\r\n                            configurePlayIntro(intro, strings, terms);\r\n                            setTimeout(function () {\r\n                                intro.start();\r\n                            }, 1000);\r\n                        }).fail(notification.exception);\r\n                    }\r\n\r\n                }, // ...end of playpage function.\r\n\r\n            }; // ...end of init var.\r\n            return init;\r\n        }\r\n); // ...end of module define function.\r\n\r\nfunction configureEditIntro(intro, strings, keys) {\r\n    intro.setOptions({\r\n        nextLabel: strings[keys.indexOf('nextstep')],\r\n        prevLabel: strings[keys.indexOf('prevstep')],\r\n        skipLabel: strings[keys.indexOf('skiptutorial')],\r\n        doneLabel: strings[keys.indexOf('donetutorial')],\r\n        steps: [\r\n            {\r\n                element: '#treasurehunt-editor',\r\n                intro: strings[keys.indexOf('welcome_edit_tour')],\r\n                position: 'floating'\r\n            },\r\n            {\r\n                element: '#mapedit',\r\n                intro: strings[keys.indexOf('map_tour')],\r\n                position: 'floating'\r\n            },\r\n            {\r\n                element: '#roadlist',\r\n                intro: strings[keys.indexOf('roads_tour')],\r\n                position: 'top'\r\n            },\r\n            {\r\n                element: '#stagelistpanel',\r\n                intro: strings[keys.indexOf('stages_tour')],\r\n                position: 'right'\r\n            },\r\n            {\r\n                element: '#addroad',\r\n                intro: strings[keys.indexOf('addroad_tour')],\r\n                position: 'bottom'\r\n            },\r\n            {\r\n                element: '#addstage',\r\n                intro: strings[keys.indexOf('addstage_tour')],\r\n                position: 'bottom'\r\n            },\r\n            {\r\n                element: '#savestage',\r\n                intro: strings[keys.indexOf('save_tour')],\r\n                position: 'bottom'\r\n            },\r\n            {\r\n                element: '#treasurehunt-editor',\r\n                intro: strings[keys.indexOf('editend_tour')],\r\n                position: 'floating'\r\n            }\r\n        ]\r\n    });\r\n    intro.onexit(function (target) {\r\n        document.cookie = \"introEditProgress = Done\";\r\n    });\r\n    intro.oncomplete(function (target) {\r\n        document.cookie = \"introEditProgress = Done\";\r\n    });\r\n    intro.onchange(function (target) {\r\n        document.cookie = \"introEditStep = \" + target.name;\r\n        document.cookie = \"introEditProgress = Done\"; // Skip the tutorial if visited.\r\n    });\r\n}\r\n// end of configureEditIntro\r\nfunction configurePlayIntro(intro, strings, keys) {\r\n    intro.setOptions({\r\n        nextLabel: strings[keys.indexOf('nextstep')],\r\n        prevLabel: strings[keys.indexOf('prevstep')],\r\n        skipLabel: strings[keys.indexOf('skiptutorial')],\r\n        doneLabel: strings[keys.indexOf('donetutorial')],\r\n        steps: [\r\n            {\r\n                intro: strings[keys.indexOf('welcome_play_tour')],\r\n                position: 'floating'\r\n            },\r\n            {\r\n                element: '#collapsibleset', //#lastsuccessfulstage',\r\n                intro: strings[keys.indexOf('lastsuccessfulstage_tour')],\r\n                position: 'top'\r\n            },\r\n            {\r\n                element: '#mapplay',\r\n                intro: strings[keys.indexOf('mapplay_tour')],\r\n                position: 'floating'\r\n            },\r\n            {\r\n                element: '#validatelocation',\r\n                intro: strings[keys.indexOf('validatelocation_tour')],\r\n                position: 'top'\r\n            },\r\n            {\r\n                element: '#autolocate',\r\n                intro: strings[keys.indexOf('autolocate_tour')],\r\n                position: 'top'\r\n            },\r\n            {\r\n                element: '#treasurehunt-editor',\r\n                intro: strings[keys.indexOf('playend_tour')],\r\n                position: 'floating'\r\n            }\r\n        ]\r\n    });\r\n    intro.onexit(function (target) {\r\n        document.cookie = \"introPlayProgress = Done\";\r\n    });\r\n    intro.oncomplete(function (target) {\r\n        document.cookie = \"introPlayProgress = Done\";\r\n    });\r\n    intro.onchange(function (target) {\r\n        document.cookie = \"introPlayStep = \" + this._currentStep;\r\n        document.cookie = \"introPlayProgress = Done\"; // Skip the tutorial if visited.\r\n    });\r\n    intro.onafterchange(function (target) {\r\n        var parentElem = target.parentElement;\r\n        while (parentElem !== null) {\r\n            if (parentElem.dataset.role == 'panel') {\r\n                parentElem.style = \"z-index: 1001 !important\";\r\n                break;\r\n            } else {\r\n                parentElem = parentElem.parentElement;\r\n            }\r\n        }\r\n    });\r\n}"],"file":"tutorial.min.js"}